"use strict";function asyncGeneratorStep(e,n,t,o,a,i,s){try{var l=e[i](s),r=l.value}catch(e){return void t(e)}l.done?n(r):Promise.resolve(r).then(o,a)}function _asyncToGenerator(l){return function(){var e=this,s=arguments;return new Promise(function(n,t){var o=l.apply(e,s);function a(e){asyncGeneratorStep(o,n,t,a,i,"next",e)}function i(e){asyncGeneratorStep(o,n,t,a,i,"throw",e)}a(void 0)})}}class FeedbackWidget{constructor(e){this._elementId=e,this._key="feedback_widget"}get elementId(){return this._elementId}show(e,n){var t=document.getElementById(this._elementId);e instanceof String||"string"==typeof e?($(t).find(".alert__title").text(e),$(t).find(".alert__message").text(null)):e.hasOwnProperty("title")&&e.hasOwnProperty("msg")&&($(t).find(".alert__title").text(e.title),$(t).find(".alert__message").text(e.msg)),t.classList.add("success"==n?"alert-success":"alert-danger"),"success"==n&&(t.classList.add("alert-hover"),$(t).find(".alert__close").hide()),"none"===t.style.display&&(t.style.display="block"),this.log({message:e,type:n})}hide(){var e=document.getElementById(this._elementId);"block"===e.style.display&&(e.style.display="none")}log(e){var n,t=window.localStorage;null!=t.getItem(this._key)?((n=JSON.parse(t.getItem(this._key))).push(e),10<n.length&&n.shift(),t.setItem(this._key,JSON.stringify(n))):(console.log("This key is used for the first time"),t.setItem(this._key,"["+JSON.stringify(e)+"]"))}removeLog(){localStorage.removeItem(this._key)}history(){for(var e=null!=(e=localStorage.getItem(this._key))?e:[],n=JSON.parse(e),t=0;t<n.length;t++)console.log("".concat(n[t].type," - ").concat(n[t].message.title," : ").concat(n[t].message.msg))}}var API_URL="https://localhost:44339/api/",Game=(e=>{console.log("Hallo vanuit een module!");var o={apiUrl:e},a=e=>/[A-Z]/.test(e),i=e=>/[a-z]/.test(e),s=e=>/\d/.test(e),l=e=>/[^a-zA-Z\d\s:]/g.test(e),r=(e,n)=>{n?(e.classList.add("included"),e.classList.remove("not-included"),e.classList.remove("none"),e.children[0].innerText="task_alt"):(e.classList.add("not-included"),e.classList.remove("none"),e.classList.remove("included"),e.children[0].innerText="close")},c=e=>{for(var n of e.parentNode.children)if(n.classList.contains("password__strength__checker")){n=n.children[1].children;if(0===e.value.length){for(var t of n)t.classList.contains("none")||(t.classList.add("none"),t.children[0].innerText="close"),t.classList.remove("not-included","included");return}r(n[0],12<=e.value.length&&e.value.length<=128),r(n[1],a(e.value)),r(n[2],i(e.value)),r(n[3],s(e.value)),r(n[4],l(e.value))}},d=e=>{for(var n of e.parentNode.children)n.classList.contains("password__strength__checker")&&(n.style.display="none")},u=e=>{var n,t;for(n of document.getElementsByClassName("password__strength__checker"))n.style.display="none";for(t of e.parentNode.children)t.classList.contains("password__strength__checker")&&(t.style.display="flex")},m=e=>{e.style.display="none";for(var n of e.parentNode.children)n.classList.contains("hide__password__icon")&&(n.style.display="block"),"input"===n.tagName.toLowerCase()&&(n.type="text")},p=e=>{e.style.display="none";for(var n of e.parentNode.children)n.classList.contains("show__password__icon")&&(n.style.display="block"),"input"===n.tagName.toLowerCase()&&(n.type="password")},f=e=>{var n=document.getElementById("online__player__counter");null!==n&&(n.innerText="players online: ".concat(e))},h=e=>{e=document.getElementById(e);if(null==e)throw new Error("Dialog Id Not Found!");"function"==typeof e.showModal&&e.close()},v=e=>{e=document.getElementById(e);if(null==e)throw new Error("Dialog Id Not Found!");"function"==typeof e.showModal&&e.showModal()},t=(e,a)=>{document.querySelectorAll(".fiche").forEach(n=>{var t=parseInt(n.getAttribute("x")),o=parseInt(n.getAttribute("y"));e.forEach(e=>{e.x==t&&e.y==o&&(1==a?(n.classList.remove("fiche-white","fiche-empty"),n.classList.add("fiche-black")):(n.classList.remove("fiche-black","fiche-empty"),n.classList.add("fiche-white")))})})},g=e=>{console.log(e),window.location.pathname=e},_=(e,n)=>{console.log("Movement"),console.log("Turn",n),t(e,n);document.querySelectorAll(".fiche").forEach(e=>{e.disabled=!1,e.style="pointer-events: auto;"});e=document.querySelector(".game__ownedboardbalance__player-1");document.querySelector(".game__ownedboardbalance__player-2").classList.remove("big"),e.classList.add("big")},y=function(){var n=_asyncToGenerator(function*(e){console.log(e);var n=document.getElementById("wrong_move_info");console.log("Element:"+n),n.innerHTML=iconText("notification_important",e),n.style.display="flex",yield delay(4e3),n.style.display="none"});return function(e){return n.apply(this,arguments)}}(),w=(e,n)=>{t(e,n);document.querySelectorAll(".fiche").forEach(e=>{e.disabled=!0,e.style="pointer-events: none;"});e=document.querySelector(".game__ownedboardbalance__player-1");document.querySelector(".game__ownedboardbalance__player-2").classList.add("big"),e.classList.remove("big")},I=e=>{console.log("Game Finished",e)},b=e=>{console.log("Error",e),console.log("TODO: ","create a proper popup error message")},k=()=>{console.debug("Game Created");var e=window.location.pathname.split("/"),e=e[e.length-1];console.debug("Pagename:",e),"AvailableGames"===e&&window.location.reload()};return{init:e=>{Game.Model.init(),Game.ComponentEvents.init(),Game.ComponentEvents.addClick("btn-update-password",v,"update-user-password-dialog"),Game.ComponentEvents.addClick("btn-update-2fa",v,"update-2fa-dialog"),Game.ComponentEvents.addClick("btn-close-update-user-password-dialog",h,"update-user-password-dialog"),Game.Model.listen("Redirect",g),Game.Model.listen("OnMove",_),Game.Model.listen("OnWrongMove",y),Game.Model.listen("OnDisableMove",w),Game.Model.listen("OnFinish",I),Game.Model.listen("OnError",b),Game.Model.listen("OnPlayerOnline",f),Game.Model.listen("OnCreateGame",k);var n=window.location.pathname.split("/"),t=n.length-1;Game.LoginWith2faPage.init(n[t]),Game.RegisterPage.init(n[t]),Game.ComponentEvents.addClickOnClass("show__password__icon",m),Game.ComponentEvents.addClickOnClass("hide__password__icon",p),Game.ComponentEvents.addOnFocus("register__password",u),Game.ComponentEvents.addOnFocusOut("register__password",d),Game.ComponentEvents.addOnFocus("register__confirm__password",u),Game.ComponentEvents.addOnFocusOut("register__confirm__password",d),Game.ComponentEvents.addOnInput("register__password",c),Game.ComponentEvents.addOnInput("register__confirm__password",c),console.log(o.apiUrl),e()}}})(API_URL),delay=(Game.ComponentEvents={init:()=>{},addClick:(e,n,t)=>{var o=document.getElementById(e);null==o?console.error("Component Id: ".concat(e," Not Found")):o.addEventListener("click",()=>{n(t)})},addClickOnClass:(e,n)=>{var t=document.getElementsByClassName(e);if(null==t)console.error("Component class: ".concat(e," Not Found"));else{var o;for(o of t)!function(e){e.addEventListener("click",()=>{n(e)})}(o)}},addOnFocus:(e,n)=>{var t=document.getElementById(e);null==t?console.error("Component Id: ".concat(e," Not Found")):t.addEventListener("focus",()=>{n(t)})},addOnFocusOut:(e,n)=>{var t=document.getElementById(e);null==t?console.error("Component Id: ".concat(e," Not Found")):t.addEventListener("focusout",()=>{n(t)})},addOnInput:(e,n)=>{var t=document.getElementById(e);null==t?console.error("Component Id: ".concat(e," Not Found")):t.addEventListener("input",()=>{n(t)})}},Game.Data=(()=>{var a={apiKey:"",hubUrl:"/reversiHub",hubConnection:"",mock:[{url:"api/Spel/Beurt/1",data:1}]},o={environment:"development"},n=()=>{try{a.hubConnection.start()}catch(e){console.debug(e),setTimeout(n,3e3)}};return{init:e=>{if(console.log("Data: Init"),$("#game-resign-button").on("click",e=>{a.hubConnection.invoke("OnSurrender")}),$("#game-pass-button").on("click",e=>{a.hubConnection.invoke("OnMove",{x:-1,y:-1,hasPassed:!0})}),$("#reversiboardform").on("submit",e=>{e.preventDefault(),clickAudio.play();var n=parseInt(e.originalEvent.submitter.getAttribute("x")),e=parseInt(e.originalEvent.submitter.getAttribute("y"));a.hubConnection.invoke("OnMove",{x:n,y:e,hasPassed:!1})}),a.hubConnection=(new signalR.HubConnectionBuilder).withUrl(a.hubUrl).build(),a.hubConnection.onclose(_asyncToGenerator(function*(){yield n()})),n(),"production"!=e&&"development"!=e)throw new Error("De environment welke gebruikt dient te worden bestaat niet.");return o.environment=e,!0},get:e=>{return"development"==o.environment?(n=e,t=a.mock.filter(e=>e.url==n),new Promise((e,n)=>{e(t)})):$.get(e).then(e=>e).catch(e=>{console.error(e.message)});var n,t},listen:function(e,o){console.log("Listening to: ",e),a.hubConnection.on(e,function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];console.log(n),o(...n)})}}})(),Game.Model={init:()=>(Game.Data.init("development"),Game.Data.listen("StartGame",()=>{}),Game.Data.listen("Redirect",()=>{},"url"),!0),listen:(e,n)=>{Game.Data.listen(e,n)},getGameState:()=>Game.Data.get("api/Spel/Beurt/1").then(e=>{if(null!=e&&null!=e[0].data&&0<=e[0].data&&e[0].data<=2)return e[0];throw new Error("Er ging iets mis met het opvragen van de huidige gamestate.")})},Game.Reversi=(()=>{console.log("hallo, vanuit module Reversi.");return{init:()=>!0}})(),Game.LoginWith2faPage=(()=>{var r="LoginWith2fa",c={currentPage:"",isLocated:!1,pincode:[]};return{init:e=>{var n,o,t,a,i,s,l;c.currentPage=e,c.isLocated=r===e,c.isLocated&&(console.log("maskinput"),e=document.getElementsByName("Input.Pincode1"),n=$("#twofa__login__form"),o=n.find("#twofa__login__form__pincode").find("input"),t=n.find('[name="Input.Pincode1"]'),a=n.find('[name="Input.Pincode2"]'),i=n.find('[name="Input.Pincode3"]'),s=n.find('[name="Input.Pincode4"]'),l=n.find('[name="Input.Pincode5"]'),n.find('[name="Input.Pincode6"]'),o.on("keyup",e=>{9!==(e.keyCode||e.which)||e.shiftKey||(e.preventDefault(),$("#twofa__login").focus())}).inputmask({mask:"9",placeholder:"",showMaskOnHover:!1,showMaskOnFocus:!1,clearIncomplete:!0,onincomplete:function(){},oncleared:function(){var e=o.index(this),e=e-1;if(!(0<=e))return!1;o.eq(e).val(""),o.eq(e).focus(),c.pincode.splice(-1,1)},onKeyValidation:function(e,n){var t=o.index(this);t-1<6&&o.eq(t+1).focus()},onBeforePaste:function(e,n){return $.each(e.split(""),function(e,n){o.eq(e).val(n)}),!1}}),$('[name="Input.Pincode1"]').on("focus",function(e){}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),$('[name="Input.Pincode2"]').focus()}}),$('[name="Input.Pincode2"]').on("focus",function(e){""===t.val().trim()&&(e.preventDefault(),c.pincode=[],o.each(function(){$(this).val("")}),t.focus())}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),$('[name="Input.Pincode3"]').focus()}}),$('[name="Input.Pincode3"]').on("focus",function(e){""!==t.val().trim()&&""!==a.val().trim()||(e.preventDefault(),c.pincode=[],o.each(function(){$(this).val("")}),t.focus())}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),$('[name="Input.Pincode4"]').focus()}}),$('[name="Input.Pincode4"]').on("focus",function(e){""!==t.val().trim()&&""!==a.val().trim()&&""!==i.val().trim()||(e.preventDefault(),c.pincode=[],o.each(function(){$(this).val("")}),t.focus())}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),$('[name="Input.Pincode5"]').focus()}}),$('[name="Input.Pincode5"]').on("focus",function(e){""!==t.val().trim()&&""!==a.val().trim()&&""!==i.val().trim()&&""!==s.val().trim()||(e.preventDefault(),c.pincode=[],o.each(function(){$(this).val("")}),t.focus())}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),$('[name="Input.Pincode6"]').focus()}}),$('[name="Input.Pincode6"]').on("focus",function(e){""!==t.val().trim()&&""!==a.val().trim()&&""!==i.val().trim()&&""!==s.val().trim()&&""!==l.val().trim()||(e.preventDefault(),c.pincode=[],o.each(function(){$(this).val("")}),t.focus())}).inputmask({oncomplete:function(){c.pincode.push($(this).val()),6!==c.pincode.length?(c.pincode=[],o.each(function(){$(this).val("")}),$('[name="Input.Pincode1"]').focus()):o.each(function(){$(this).prop("disabled",!0)})}}),e.onfocus=e=>{},console.log(e))}}})(),Game.RegisterPage={init:e=>{0}},n=>new Promise(e=>setTimeout(e,n))),iconText=(e,n)=>"<i class='material-icons'>".concat(e,"</i> ").concat(n);